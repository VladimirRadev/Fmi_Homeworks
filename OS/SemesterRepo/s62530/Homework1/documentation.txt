Домашно 1 По ОС 2021/2022 летен семестър

Владимир Валентинов Радев СИ 2 курс 1 група

###########################################

1.) Приемам 4 аргумента в изпълнимия  script  unpack.sh , като аргументите трябва да са 1: зип файл от моодле, 2:папка за ок резултати,
3:папка за failed резултати и 4: текстов файл за резултатите 
Като условията са $1 да съществува и да е .zip archive $2,$3,$4 да не съществуват и да се създадат от скрипта ( всички тези условия съм ги
разгледал чрез проверки и съответно exit при откриване на грешка , exit статусите които връщам са предоставени като коментар в началото на
самия скрипт)

2.) Основната логика ми е да разархивирам $1 в временна папка в която ще работя и накрая ще изтрия , в тази папка ще получа други папки които
са съответно assignment filevete на всеки студент предал работата си в моодле ( ще приемам че фн-* - това фн е истинското фн на студента)
За всяка подпапка в нея се крие това което студента е предал като архив. Именно с този архив ще работя през цялото време като чрез операцията
file -z fileToExt ще получавам разяснение за това какво се крие в файла ( тоест може да е компресиран + архивиран, само архивиран , нито архивиран
нито компресиран ) . Ако е компресиран ще се опитам да го декомпресирам и след това да го разархивирам, ако е само архивиран ще го разархивирам,
а ако не е нито компресиран нито архивиран директно ще го пращам в failed/

   2.1) Обхождането по папки с студентски assignmenti ще го правя с while цикъл , като един стате на while е една папка от вида 
    fn-*/
   2.2)  Aко в тази папка има повече от един файл или има файл с нито един от форматите ( tar,tar.xz,tar.bz2,zip,rar,tar.gz и тн) то този
файл/файлове директно се изпращат в failed/fn/
   2.3) Ако има точно един файл и този файл е някой от форматите които трябва да разглеждаме и да се опитаме да ги изпратим в ок/ то влизаме 
в проверките ( 9 на брой  3x3 ) ( Тези неща идват от fileDescriptiona а не от това как са били кръстени , тоест един файл може да е кръстен
алабала.tar но всъщност да е алабала.tar.xz , gri се проверява с прост греп още преди проверките gri=0 <=> match '^fn.tar.xz$')
      *Ако е компресиран с xz и то е индикирано от file -z със : 'XZ compressed data'
	** Декомпресираме го и после проверяваме дали е tar , ако е tar се екстрактва и се изпраща в ok/ като това е единствения случай в който
		grf=0. Ако е изпратено съдържанието в ок/ се изпринтва и един ред с флаговете за съответния студент в $4 (ресулт.тхт) и се 
		продължава с изпълнението на while-a ( continue).  При всеки един опит за декомпрес/екстракт ако получим грешка от операцията то директно се изпраща в failed/ самия файл
		защото по условие се казва че при грешка при разархивирането изпращаме съдържанието в  failed/ 

		Имаме 5 случая които разглеждам ( не съм правил влизане на вътре както е показано в някои от примерите , имам 4 несъответствия(reda) във флаговете спрямо подадения example/flags.txt ( другите са mi верни ), a съдържание
		в example/ок/ и във example/failed/ е идентично със тези които скрипта създава като резултатни )
		1]  Директория с правилно име + некви неща ( Пр. 2 неща) -> резултат за nd,grd -> 0 0
		2]  Нямаме директория въобще , но има некви неща (Пр. 3 неща) -> резултат за nd,grd -> 1 1
		3] Директория с правилно име + без никви други неща -> резултат за nd, grd -> 0 0
		4] Има директория с грешно име + папки повече или равни на една -> резултат за nd, grd -> 0 1
		5] Има директория с правилно име + има поне една папка на второ ниво -> резултата за nd, grd -> 1 0 

		\\ може някои да са грешни но условието не е изразено буквално и може да има интерпретации

	** грф= 1 директно . Декомпресираме го и после проверяваме дали е zip , ако е zip се екстрактва и се изпраща в ok/. 
		 Ако е изпратено съдържанието в ок/ се изпринтва и един ред с флаговете за съответния студент в $4 (ресулт.тхт) и се 
		продължава с изпълнението на while-a ( continue).  При всеки един опит за декомпрес/екстракт ако получим грешка от операцията то директно се изпраща в failed/ самия файл
		защото по условие се казва че при грешка при разархивирането изпращаме съдържанието в  failed/ 

		Имаме 5 случая които разглеждам ( не съм правил влизане на вътре както е показано в някои от примерите , имам 4 несъответствия във флаговете спрямо подадения example ( другите са верни ), a съдържание
		в ок/ и във failed/ е идентично със тези които скрипта създава като резултатни )
		1]  Директория с правилно име + некви неща ( Пр. 2 неща) -> резултат за nd,grd -> 0 0
		2]  Нямаме директория въобще , но има некви неща (Пр. 3 неща) -> резултат за nd,grd -> 1 1
		3] Директория с правилно име + без никви други неща -> резултат за nd, grd -> 0 0
		4] Има директория с грешно име + папки повече или равни на една -> резултат за nd, grd -> 0 1
		5] Има директория с правилно име + има поне една папка на второ ниво -> резултата за nd, grd -> 1 0 

		\\ може някои да са грешни но условието не е изразено буквално и може да има интерпретации	


	**	грф= 1 директно . Декомпресираме го и после проверяваме дали е rar, ако rar se екстрактва и се изпраща в ok/. 
		 Ако е изпратено съдържанието в ок/ се изпринтва и един ред с флаговете за съответния студент в $4 (ресулт.тхт) и се 
		продължава с изпълнението на while-a ( continue).  При всеки един опит за декомпрес/екстракт ако получим грешка от операцията то директно се изпраща в failed/ самия файл
		защото по условие се казва че при грешка при разархивирането изпращаме съдържанието в  failed/ 

		Имаме 5 случая които разглеждам ( не съм правил влизане на вътре както е показано в някои от примерите , имам 4 несъответствия във флаговете спрямо подадения example ( другите са верни ), a съдържание
		в ок/ и във failed/ е идентично със тези които скрипта създава като резултатни )
		1]  Директория с правилно име + некви неща ( Пр. 2 неща) -> резултат за nd,grd -> 0 0
		2]  Нямаме директория въобще , но има некви неща (Пр. 3 неща) -> резултат за nd,grd -> 1 1
		3] Директория с правилно име + без никви други неща -> резултат за nd, grd -> 0 0
		4] Има директория с грешно име + папки повече или равни на една -> резултат за nd, grd -> 0 1
		5] Има директория с правилно име + има поне една папка на второ ниво -> резултата за nd, grd -> 1 0 

		\\ може някои да са грешни но условието не е изразено буквално и може да има интерпретации	


     & Ако е компресиран с bz2 и то е индикирано от file -z със : 'bzip2 compressed data'

	grf=1 direktno 


	&& Декомпресираме го и после проверяваме дали е tar , ако е tar се екстрактва и се изпраща в ok/ 
		. Ако е изпратено съдържанието в ок/ се изпринтва и един ред с флаговете за съответния студент в $4 (ресулт.тхт) и се 
		продължава с изпълнението на while-a ( continue).  При всеки един опит за декомпрес/екстракт ако получим грешка от операцията то директно се изпраща в failed/ самия файл
		защото по условие се казва че при грешка при разархивирането изпращаме съдържанието в  failed/ 

		Имаме 5 случая които разглеждам ( не съм правил влизане на вътре както е показано в някои от примерите , имам 4 несъответствия във флаговете спрямо подадения example ( другите са верни ), a съдържание
		в ок/ и във failed/ е идентично със тези които скрипта създава като резултатни )
		1]  Директория с правилно име + некви неща ( Пр. 2 неща) -> резултат за nd,grd -> 0 0
		2]  Нямаме директория въобще , но има некви неща (Пр. 3 неща) -> резултат за nd,grd -> 1 1
		3] Директория с правилно име + без никви други неща -> резултат за nd, grd -> 0 0
		4] Има директория с грешно име + папки повече или равни на една -> резултат за nd, grd -> 0 1
		5] Има директория с правилно име + има поне една папка на второ ниво -> резултата за nd, grd -> 1 0 

		\\ може някои да са грешни но условието не е изразено буквално и може да има интерпретации

	&&  Декомпресираме го и после проверяваме дали е zip , ако е zip се екстрактва и се изпраща в ok/. 
		 Ако е изпратено съдържанието в ок/ се изпринтва и един ред с флаговете за съответния студент в $4 (ресулт.тхт) и се 
		продължава с изпълнението на while-a ( continue).  При всеки един опит за декомпрес/екстракт ако получим грешка от операцията то директно се изпраща в failed/ самия файл
		защото по условие се казва че при грешка при разархивирането изпращаме съдържанието в  failed/ 

		Имаме 5 случая които разглеждам ( не съм правил влизане на вътре както е показано в някои от примерите , имам 4 несъответствия във флаговете спрямо подадения example ( другите са верни ), a съдържание
		в ок/ и във failed/ е идентично със тези които скрипта създава като резултатни )
		1]  Директория с правилно име + некви неща ( Пр. 2 неща) -> резултат за nd,grd -> 0 0
		2]  Нямаме директория въобще , но има некви неща (Пр. 3 неща) -> резултат за nd,grd -> 1 1
		3] Директория с правилно име + без никви други неща -> резултат за nd, grd -> 0 0
		4] Има директория с грешно име + папки повече или равни на една -> резултат за nd, grd -> 0 1
		5] Има директория с правилно име + има поне една папка на второ ниво -> резултата за nd, grd -> 1 0 

		\\ може някои да са грешни но условието не е изразено буквално и може да има интерпретации	


	&&	 Декомпресираме го и после проверяваме дали е rar, ако rar se екстрактва и се изпраща в ok/. 
		 Ако е изпратено съдържанието в ок/ се изпринтва и един ред с флаговете за съответния студент в $4 (ресулт.тхт) и се 
		продължава с изпълнението на while-a ( continue).  При всеки един опит за декомпрес/екстракт ако получим грешка от операцията то директно се изпраща в failed/ самия файл
		защото по условие се казва че при грешка при разархивирането изпращаме съдържанието в  failed/ 

		Имаме 5 случая които разглеждам ( не съм правил влизане на вътре както е показано в някои от примерите , имам 4 несъответствия във флаговете спрямо подадения example ( другите са верни ), a съдържание
		в ок/ и във failed/ е идентично със тези които скрипта създава като резултатни )
		1]  Директория с правилно име + некви неща ( Пр. 2 неща) -> резултат за nd,grd -> 0 0
		2]  Нямаме директория въобще , но има некви неща (Пр. 3 неща) -> резултат за nd,grd -> 1 1
		3] Директория с правилно име + без никви други неща -> резултат за nd, grd -> 0 0
		4] Има директория с грешно име + папки повече или равни на една -> резултат за nd, grd -> 0 1
		5] Има директория с правилно име + има поне една папка на второ ниво -> резултата за nd, grd -> 1 0 

		\\ може някои да са грешни но условието не е изразено буквално и може да има интерпретации	


    $ Ако е компресиран с gz и то е индикирано от file -z със : 'gzip compressed data.'

	grf=1 direktno 

	$$ Декомпресираме го и после проверяваме дали е tar , ако е tar се екстрактва и се изпраща в ok/ 
		. Ако е изпратено съдържанието в ок/ се изпринтва и един ред с флаговете за съответния студент в $4 (ресулт.тхт) и се 
		продължава с изпълнението на while-a ( continue).  При всеки един опит за декомпрес/екстракт ако получим грешка от операцията то директно се изпраща в failed/ самия файл
		защото по условие се казва че при грешка при разархивирането изпращаме съдържанието в  failed/ 

		Имаме 5 случая които разглеждам ( не съм правил влизане на вътре както е показано в някои от примерите , имам 4 несъответствия във флаговете спрямо подадения example ( другите са верни ), a съдържание
		в ок/ и във failed/ е идентично със тези които скрипта създава като резултатни )
		1]  Директория с правилно име + некви неща ( Пр. 2 неща) -> резултат за nd,grd -> 0 0
		2]  Нямаме директория въобще , но има некви неща (Пр. 3 неща) -> резултат за nd,grd -> 1 1
		3] Директория с правилно име + без никви други неща -> резултат за nd, grd -> 0 0
		4] Има директория с грешно име + папки повече или равни на една -> резултат за nd, grd -> 0 1
		5] Има директория с правилно име + има поне една папка на второ ниво -> резултата за nd, grd -> 1 0 

		\\ може някои да са грешни но условието не е изразено буквално и може да има интерпретации

	$$ Декомпресираме го и после проверяваме дали е zip , ако е zip се екстрактва и се изпраща в ok/. 
		 Ако е изпратено съдържанието в ок/ се изпринтва и един ред с флаговете за съответния студент в $4 (ресулт.тхт) и се 
		продължава с изпълнението на while-a ( continue).  При всеки един опит за декомпрес/екстракт ако получим грешка от операцията то директно се изпраща в failed/ самия файл
		защото по условие се казва че при грешка при разархивирането изпращаме съдържанието в  failed/ 

		Имаме 5 случая които разглеждам ( не съм правил влизане на вътре както е показано в някои от примерите , имам 4 несъответствия във флаговете спрямо подадения example ( другите са верни ), a съдържание
		в ок/ и във failed/ е идентично със тези които скрипта създава като резултатни )
		1]  Директория с правилно име + некви неща ( Пр. 2 неща) -> резултат за nd,grd -> 0 0
		2]  Нямаме директория въобще , но има некви неща (Пр. 3 неща) -> резултат за nd,grd -> 1 1
		3] Директория с правилно име + без никви други неща -> резултат за nd, grd -> 0 0
		4] Има директория с грешно име + папки повече или равни на една -> резултат за nd, grd -> 0 1
		5] Има директория с правилно име + има поне една папка на второ ниво -> резултата за nd, grd -> 1 0 

		\\ може някои да са грешни но условието не е изразено буквално и може да има интерпретации	


	$$ Декомпресираме го и после проверяваме дали е rar, ако rar se екстрактва и се изпраща в ok/. 
		 Ако е изпратено съдържанието в ок/ се изпринтва и един ред с флаговете за съответния студент в $4 (ресулт.тхт) и се 
		продължава с изпълнението на while-a ( continue).  При всеки един опит за декомпрес/екстракт ако получим грешка от операцията то директно се изпраща в failed/ самия файл
		защото по условие се казва че при грешка при разархивирането изпращаме съдържанието в  failed/ 

		Имаме 5 случая които разглеждам ( не съм правил влизане на вътре както е показано в някои от примерите , имам 4 несъответствия във флаговете спрямо подадения example ( другите са верни ), a съдържание
		в ок/ и във failed/ е идентично със тези които скрипта създава като резултатни )
		1]  Директория с правилно име + некви неща ( Пр. 2 неща) -> резултат за nd,grd -> 0 0
		2]  Нямаме директория въобще , но има некви неща (Пр. 3 неща) -> резултат за nd,grd -> 1 1
		3] Директория с правилно име + без никви други неща -> резултат за nd, grd -> 0 0
		4] Има директория с грешно име + папки повече или равни на една -> резултат за nd, grd -> 0 1
		5] Има директория с правилно име + има поне една папка на второ ниво -> резултата за nd, grd -> 1 0 

		\\ може някои да са грешни но условието не е изразено буквално и може да има интерпретации


2.4) Ако е само archive но не е компресиран правим същата логика за tar,zip,rar 
		
		grf=1 direktno	

		 Ако е изпратено съдържанието в ок/ се изпринтва и един ред с флаговете за съответния студент в $4 (ресулт.тхт) и се 
		продължава с изпълнението на while-a ( continue).  При всеки един опит за декомпрес/екстракт ако получим грешка от операцията то директно се изпраща в failed/ самия файл
		защото по условие се казва че при грешка при разархивирането изпращаме съдържанието в  failed/ 

		Имаме 5 случая които разглеждам ( не съм правил влизане на вътре както е показано в някои от примерите , имам 4 несъответствия във флаговете спрямо подадения example ( другите са верни ), a съдържание
		в ок/ и във failed/ е идентично със тези които скрипта създава като резултатни )
		1]  Директория с правилно име + некви неща ( Пр. 2 неща) -> резултат за nd,grd -> 0 0
		2]  Нямаме директория въобще , но има некви неща (Пр. 3 неща) -> резултат за nd,grd -> 1 1
		3] Директория с правилно име + без никви други неща -> резултат за nd, grd -> 0 0
		4] Има директория с грешно име + папки повече или равни на една -> резултат за nd, grd -> 0 1
		5] Има директория с правилно име + има поне една папка на второ ниво -> резултата за nd, grd -> 1 0 

		\\ може някои да са грешни но условието не е изразено буквално и може да има интерпретации


2.5) Ако стигнем до този етап на програмата и той не е архивиран, арх + комп , а е просто файл
	Директно се изпраща съдържанието на папката  на съответния студент в папката failed/

2.6) Накрая преди да приключим ( вече сме извън while) : Изтриваме темп папката с която работихме през цялото време /tmp/xtDir/ , sortirame resultatniqTxt чрез използването на временнен
файл ,трием временния файл и приключваме

2.7) На някои места в кода може да съм забравил някои коментари или пък са оставени за пояснение / по-лесно тестване , биха били от полза ако се тестват ръчно всеки един компонент от 
логиката на скрипта .


###########################################




	
